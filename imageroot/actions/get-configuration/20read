

#!/usr/bin/env python3

#
# Copyright (C) 2022 Nethesis S.r.l.
# SPDX-License-Identifier: GPL-3.0-or-later
#

#
# Read configuration
#

import os
import sys
import json
import agent

# Prepare return variable
config = {}

# Read current configuration from the environment file
config["hostname_certificate"] = os.getenv("EJABBERD_HOST_CERTIFICATE","")
config["ldap_domain"] = os.getenv("EJABBERD_LDAP_DOMAIN",'')
config["adminsList"] = os.getenv("EJABBERD_ADMIN_LIST",'')
config["s2s"] = os.getenv("EJABBERD_S2S",'') == "True"
config["http_upload"] = os.getenv("EJABBERD_HTTP_UPLOAD",'') == "True"
config["mod_mam_status"] = os.getenv("EJABBERD_MOD_MAM_STATUS",'') == "True"
config["mod_http_upload_quota_status"] = os.getenv("EJABBERD_MOD_HTTP_UPLOAD_QUOTA_STATUS",'') == "True"
config["shaper_normal"] = int(os.getenv("EJABBERD_SHAPER_NORMAL",500000))
config["shaper_fast"] = int(os.getenv("EJABBERD_SHAPER_FAST",1000000))

# Dump the configuration to stdout
json.dump(config, fp=sys.stdout)
